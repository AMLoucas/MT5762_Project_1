findCorrelation(cannabisData$Se, cannabisData$Ti)
# Se with Sc
findCorrelation(cannabisData$Se, cannabisData$Tm)
install.packages("pgirmess")
library(pgirmess)
# Applied Anova test, but because it does not follow normality but has equal
# standard deviation we have to use Kruskal test on Se.
Se.residuals_kruskal <- kruskalmc(Ti ~ Group, data=plant)
# Applied Anova test, but because it does not follow normality but has equal
# standard deviation we have to use Kruskal test on Se.
Se.residuals_kruskal <- kruskalmc(Se ~ Group, data=cannabisData)
Se.residuals_kruskal
summary(Se.residuals_kruskal)
# Applied Anova test, but because it does not follow normality but has equal
# standard deviation we have to use Kruskal test on Se.
Se.residuals_kruskal <- kruskal.test(Se ~ Group, data=cannabisData)
summary(Se.residuals_kruskal)
Se.residuals_kruskal
install.packages("onewaytests")
library(onewaytests)
# Cannot Apply Anova test because data does not have constant spread in there groups of data.
# Resulting we need to use an alternative Anova test that does not assumes equal
# standarrd deviations.We will use the Welch's Anova test and we have normality here.
# Sm
Sm.residuals_welch <- welch.test(Sm ~ Group, data=plant)
# Cannot Apply Anova test because data does not have constant spread in there groups of data.
# Resulting we need to use an alternative Anova test that does not assumes equal
# standarrd deviations.We will use the Welch's Anova test and we have normality here.
# Sm
Sm.residuals_welch <- welch.test(Sm ~ Group, data=cannabisData)
# Tm
Tm.residuals_welch <- welch.test(Tm ~ Group, data=cannabisData)
#### Commands needed to execute Question 2.
# Calling Self-declared function to apply ANOVA TEST for each element.
# Sc
Sc.residuals <- applyAnovaTest(cannabisData, cannabisData$Sc)
# Ti
Ti.residuals <- applyAnovaTest(cannabisData, cannabisData$Ti)
# Se
# Cannot Apply Anova test, because it does not follow normality but has equal
# standard deviation we have to use Kruskal test on Se. Kruskal assumes
# equal standard deviation.
Se.residuals_kruskal <- kruskal.test(Se ~ Group, data=cannabisData)
Se.residuals_kruskal
kruskalmc(Se ~ Group, data=cannabisData)
# Cannot Apply Anova test because data does not have constant spread in there groups of data.
# Resulting we need to use an alternative Anova test that does not assumes equal
# standarrd deviations.We will use the Welch's Anova test and we have normality here.
# Sm
Sm.residuals_welch <- welch.test(Sm ~ Group, data=cannabisData)
# Importing package tidyverse to use powerful functions to clean data and create plots.
# Importing package car to use levene's test to check assumptions for ANalysis Of VAriance.
# You need to have both packages (tidyverse, car) installed to run the R-Script.
# Tidyverse import overrides two in built functions filter() and log()
library(tidyverse)
# Car import overrides a dplyr function called recode.
library(car)
# To use alternative Anova tests you need to download these 2 libraries.
library(pgirmess)
library(onewaytests)
# Cannot Apply Anova test because data does not have constant spread in there groups of data.
# Resulting we need to use an alternative Anova test that does not assumes equal
# standarrd deviations.We will use the Welch's Anova test and we have normality here.
# Sm
Sm.residuals_welch <- welch.test(Sm ~ Group, data=cannabisData)
summary(Sm.residuals_welch)
summary(Sm.residuals_welch$data)
summary(Sm.residuals_welch)
TukeyHSD(Sm.residuals_welch)
TukeyHSD(Sm.residuals_welch$data)
TukeyHSD(Sm.residuals_welch)
plot(Sm.residuals_welch)
plot(Sm.residuals_welch)
summary(Sm.residuals_welch)
Sm.residuals_welch
Sm.residuals_anova <- applyAnovaTest(cannabisData, cannabisData$Sm)
Tm.residuals_anova <- applyAnovaTest(cannabisData, cannabisData$Tm)
Sm.residuals_anova <- applyAnovaTest(cannabisData, cannabisData$Sm)
Tm.residuals_anova <- applyAnovaTest(cannabisData, cannabisData$Tm)
#### Commands needed to execute Question 3.
## calling function to find correlation between 2 elements.
# Sc with Ti
findCorrelation(cannabisData$Sc, cannabisData$Ti)
ggplot(cannabisData) %>%
geom_point(aes(x = cannabisData$Sc)) +
geom_point(aes(x = cannabisData$Ti))
ggplot(cannabisData) %>%
geom_point(aes(x = cannabisData$Sc))
ggplot(cannabisData) +
geom_point(aes(x = cannabisData$Sc))
ggplot(cannabisData) +
geom_point(aes(x = cannabisData$Sc y = cannabisData$Ti))
ggplot(cannabisData) +
geom_point(aes(x = cannabisData$Sc, y = cannabisData$Ti))
ggplot(cannabisData) +
geom_point(aes(x = cannabisData$Sc, y = cannabisData$Ti)) +
stat_smooth(x = cannabisData$Sc, y = cannabisData$Ti, mode("lm")) +
xlab("Element Ti") +
ylab("Element Sc") +
ggtitle("Relationship between elemenet Ti with Sc")
ggplot(cannabisData) +
geom_point(aes(x = cannabisData$Sc, y = cannabisData$Ti)) +
stat_smooth(x = cannabisData$Sc, y = cannabisData$Ti, method = ("lm")) +
xlab("Element Ti") +
ylab("Element Sc") +
ggtitle("Relationship between elemenet Ti with Sc")
ggplot(cannabisData) +
geom_point(aes(x = Sc, y = Ti)) +
stat_smooth(x = Sc, y = Ti, method = ("lm")) +
xlab("Element Ti") +
ylab("Element Sc") +
ggtitle("Relationship between elemenet Ti with Sc")
ggplot(cannabisData,aes(x = Sc, y = Ti)) +
geom_point() +
stat_smooth(method = ("lm")) +
xlab("Element Ti") +
ylab("Element Sc") +
ggtitle("Relationship between elemenet Ti with Sc")
# Se with Tm
findCorrelation(cannabisData$Se, cannabisData$Tm)
# Se with Tm
findCorrelation(cannabisData$Sc, cannabisData$Tm)
# Sm with Ti
findCorrelation(cannabisData$Sm, cannabisData$Ti)
# Sm with Ti
findCorrelation(cannabisData$Tm, cannabisData$Ti)
# Sm with Ti
findCorrelation(cannabisData$Sm, cannabisData$Tm)
# Sm with Ti
findCorrelation(cannabisData$Sm, cannabisData$Se)
# Sm with Ti
findCorrelation(cannabisData$Sm, cannabisData$Ti)
ggplot(cannabisData,aes(x = Sc, y = Ti)) +
geom_point() +
stat_smooth(method = ("lm")) +
xlab("Element Ti") +
ylab("Element Sc") +
ggtitle("Relationship between elemenet Ti with Sc")
# Sm with Tm
findCorrelation(cannabisData$Sm, cannabisData$Tm)
ggplot(cannabisData,aes(x = Sm, y = Tm)) +
geom_point() +
stat_smooth(method = ("lm")) +
xlab("Element Sm") +
ylab("Element Tm") +
ggtitle("Relationship between elemenet Sm with Tm")
ggplot(cannabisData,aes(x = Sm, y = Sc)) +
geom_point() +
stat_smooth(method = ("lm")) +
xlab("Element Sm") +
ylab("Element Sc") +
ggtitle("Relationship between elemenet Sm with Sc")
ggplot(cannabisData,aes(x = Tm, y = Ti)) +
geom_point() +
stat_smooth(method = ("lm")) +
xlab("Element Tm") +
ylab("Element Ti") +
ggtitle("Relationship between elemenet Tm with Ti")
ggplot(cannabisData,aes(x = Sm, y = Ti)) +
geom_point() +
stat_smooth(method = ("lm")) +
xlab("Element Sm") +
ylab("Element Ti") +
ggtitle("Relationship between elemenet Sm with Ti")
ggplot(cannabisData,aes(x = Se, y = Tm)) +
geom_point() +
stat_smooth(method = ("lm")) +
xlab("Element Se") +
ylab("Element Tm") +
ggtitle("Relationship between elemenet Se with Tm")
#### Commands needed to execute Question 3.
## calling function to find correlation between 2 elements.
# Sc with Ti
findCorrelation(cannabisData$Sc, cannabisData$Ti)
ggplot(cannabisData,aes(x = Sc, y = Ti)) +
geom_point() +
stat_smooth(method = ("lm")) +
xlab("Element Sc") +
ylab("Element Ti") +
ggtitle("Relationship between elemenet Sc with Ti")
ggplot(cannabisData,aes(x = Sm, y = Tm)) +
geom_point() +
stat_smooth(method = ("lm")) +
xlab("Element Sm") +
ylab("Element Tm") +
ggtitle("Relationship between elemenet Sm with Tm")
ggplot(cannabisData,aes(x = Sm, y = Sc)) +
geom_point() +
stat_smooth(method = ("lm")) +
xlab("Element Sm") +
ylab("Element Sc") +
ggtitle("Relationship between elemenet Sm with Sc")
ggplot(cannabisData,aes(x = Sm, y = Ti)) +
geom_point() +
stat_smooth(method = ("lm")) +
xlab("Element Sm") +
ylab("Element Ti") +
ggtitle("Relationship between elemenet Sm with Ti")
# Se with Tm
findCorrelation(cannabisData$Se, cannabisData$Tm)
# Se with Tm
findCorrelation(cannabisData$Sc, cannabisData$Tm)
ggplot(cannabisData,aes(x = Sc, y = Tm)) +
geom_point() +
stat_smooth(method = ("lm")) +
xlab("Element Sc") +
ylab("Element Tm") +
ggtitle("Relationship between elemenet Sc with Tm")
rm(list = ls())
# Importing package tidyverse to use powerful functions to clean data and create plots.
# Importing package car to use levene's test to check assumptions for ANalysis Of VAriance.
# You need to have all packages (tidyverse, car, pgirmess, onewaytests) installed to run the R-Script.
# Tidyverse import overrides two in built functions filter() and log()
library(tidyverse)
# Car import overrides a dplyr function called recode.
library(car)
# To use alternative Anova tests you need to download these 2 libraries.
library(pgirmess)
library(onewaytests)
# Function that implements the ANOVA test and identifies the different means for H1.
applyAnovaTest <- function(cannabisData, element){
# Anova Testing
ANOVA_result <- aov(element ~ Group, data = cannabisData)
# Outputting the results of the anova tests.
print(summary(ANOVA_result))
# Function that identifies the means that are significantly different. Using Tukeys Method
difference <- TukeyHSD(ANOVA_result)
# Prefer the table text to see results. Not plotting the data.
print(difference)
# Return residual values to apply Shapiro Test later for assumption.
return(ANOVA_result$residuals)
}
# Function that checks Constant Spread Assumption [Levene Test]. Variances are equal for ANOVA.
applyLeveneTest <- function(cannabisData, element){
leveneTest(element ~ Group, data = cannabisData)
}
# Function that checks Normality of Data. [Shapiro-Wilk]. Data comes from Normal Distribution.
applyShapiroTest <- function(residual){
print(shapiro.test(residual))
}
# Reading the data out of the CSV files.
cannabisData <- read.csv("DATA/potplants_MT5762.csv")
# Selecting only the columns i am interested in.
cannabisData <- cannabisData %>%
select(Group, Sc, Ti, Se, Sm, Tm)
# Making the groups column a factor type for more control in program.
cannabisData <- cannabisData %>%
mutate_if(is.character, as.factor)
#### Commands needed to execute Question 1 and 2.
# Using tidyverse function to plot a boxplot for each element and compare
# the elementl composition in different soil types.
# Sc
ggplot(cannabisData) +
geom_boxplot(aes(x = Group, y = Sc, colour = Group)) +
xlab("Soil Groups") +
ylab("Element Sc") +
ggtitle("Sc Elemental Composition in different soil types")
# Ti
ggplot(cannabisData) +
geom_boxplot(aes(x = Group, y = Ti, colour = Group)) +
xlab("Soil Groups") +
ylab("Element Ti") +
ggtitle("Ti Elemental Composition in different soil types")
# Se
ggplot(cannabisData) +
geom_boxplot(aes(x = Group, y = Se, colour = Group)) +
xlab("Soil Groups") +
ylab("Element Se") +
ggtitle("Se Elemental Composition in different soil types")
# Sm
ggplot(cannabisData) +
geom_boxplot(aes(x = Group, y = Sm, colour = Group)) +
xlab("Soil Groups") +
ylab("Element Sm") +
ggtitle("Sm Elemental Composition in different soil types")
# Tm
ggplot(cannabisData) +
geom_boxplot(aes(x = Group, y = Tm, colour = Group)) +
xlab("Soil Groups") +
ylab("Element Tm") +
ggtitle("Tm Elemental Composition in different soil types")
#### Commands needed to execute Question 2.
# Calling Self-declared function to apply ANOVA TEST for each element.
# Once Anova Called we test our assumptions using the Anova residuals to make
# sure our results are at the best level they can be.
# applyLeveneTest = Self-declared function to apply Levene Test and test Constant Spread Assumption.
# applyShapiroTest = Self-declared function to apply the Shapiro-Wilk Test, testing Normality.
# Sc
applyLeveneTest(cannabisData, cannabisData$Sc)
Sc.residuals <- applyAnovaTest(cannabisData, cannabisData$Sc)
applyShapiroTest(Sc.residuals)
# Ti
applyLeveneTest(cannabisData, cannabisData$Ti)
Ti.residuals <- applyAnovaTest(cannabisData, cannabisData$Ti)
applyShapiroTest(Ti.residuals)
# Cannot Apply Anova test, because it does not follow normality but has equal
# standard deviation we can use Kruskal test on Se. Kruskal assumes
# equal standard deviation.
# Se
applyLeveneTest(cannabisData, cannabisData$Se)
Se.residuals_kruskal <- kruskal.test(Se ~ Group, data=cannabisData)
kruskalmc(Se ~ Group, data=cannabisData)
# Cannot Apply Anova test because data does not have constant spread in there groups of data.
# Resulting we need to use an alternative Anova test that does not assumes equal
# standarrd deviations.We will use the Welch's Anova test and we have normality here.
# Sm
applyLeveneTest(cannabisData, cannabisData$Sm)
Sm.residuals_anova <- applyAnovaTest(cannabisData, cannabisData$Sm)
applyShapiroTest(Sm.residuals_anova)
rm(list =ls())
# Importing package tidyverse to use powerful functions to clean data and create plots.
# Importing package car to use levene's test to check assumptions for ANalysis Of VAriance.
# You need to have all packages (tidyverse, car, pgirmess, onewaytests) installed to run the R-Script.
# Tidyverse import overrides two in built functions filter() and log()
library(tidyverse)
# Car import overrides a dplyr function called recode.
library(car)
# To use alternative Anova tests you need to download these 2 libraries.
library(pgirmess)
library(onewaytests)
# Function that implements the ANOVA test and identifies the different means for H1.
applyAnovaTest <- function(cannabisData, element){
# Anova Testing
ANOVA_result <- aov(element ~ Group, data = cannabisData)
# Outputting the results of the anova tests.
print(summary(ANOVA_result))
# Function that identifies the means that are significantly different. Using Tukeys Method
difference <- TukeyHSD(ANOVA_result)
# Prefer the table text to see results. Not plotting the data.
print(difference)
# Return residual values to apply Shapiro Test later for assumption.
return(ANOVA_result$residuals)
}
# Function that checks Constant Spread Assumption [Levene Test]. Variances are equal for ANOVA.
applyLeveneTest <- function(cannabisData, element){
leveneTest(element ~ Group, data = cannabisData)
}
# Function that checks Normality of Data. [Shapiro-Wilk]. Data comes from Normal Distribution.
applyShapiroTest <- function(residual){
print(shapiro.test(residual))
}
# Reading the data out of the CSV files.
cannabisData <- read.csv("DATA/potplants_MT5762.csv")
# Selecting only the columns i am interested in.
cannabisData <- cannabisData %>%
select(Group, Sc, Ti, Se, Sm, Tm)
# Making the groups column a factor type for more control in program.
cannabisData <- cannabisData %>%
mutate_if(is.character, as.factor)
#### Commands needed to execute Question 1 and 2.
# Using tidyverse function to plot a boxplot for each element and compare
# the elementl composition in different soil types.
# Sc
ggplot(cannabisData) +
geom_boxplot(aes(x = Group, y = Sc, colour = Group)) +
xlab("Soil Groups") +
ylab("Element Sc") +
ggtitle("Sc Elemental Composition in different soil types")
# Ti
ggplot(cannabisData) +
geom_boxplot(aes(x = Group, y = Ti, colour = Group)) +
xlab("Soil Groups") +
ylab("Element Ti") +
ggtitle("Ti Elemental Composition in different soil types")
# Se
ggplot(cannabisData) +
geom_boxplot(aes(x = Group, y = Se, colour = Group)) +
xlab("Soil Groups") +
ylab("Element Se") +
ggtitle("Se Elemental Composition in different soil types")
# Sm
ggplot(cannabisData) +
geom_boxplot(aes(x = Group, y = Sm, colour = Group)) +
xlab("Soil Groups") +
ylab("Element Sm") +
ggtitle("Sm Elemental Composition in different soil types")
# Tm
ggplot(cannabisData) +
geom_boxplot(aes(x = Group, y = Tm, colour = Group)) +
xlab("Soil Groups") +
ylab("Element Tm") +
ggtitle("Tm Elemental Composition in different soil types")
#### Commands needed to execute Question 2.
# Calling Self-declared function to apply ANOVA TEST for each element.
# Once Anova Called we test our assumptions using the Anova residuals to make
# sure our results are at the best level they can be.
# applyLeveneTest = Self-declared function to apply Levene Test and test Constant Spread Assumption.
# applyShapiroTest = Self-declared function to apply the Shapiro-Wilk Test, testing Normality.
# Sc
applyLeveneTest(cannabisData, cannabisData$Sc)
Sc.residuals <- applyAnovaTest(cannabisData, cannabisData$Sc)
applyShapiroTest(Sc.residuals)
# Ti
applyLeveneTest(cannabisData, cannabisData$Ti)
Ti.residuals <- applyAnovaTest(cannabisData, cannabisData$Ti)
applyShapiroTest(Ti.residuals)
# Cannot Apply Anova test, because it does not follow normality but has equal
# standard deviation we can use Kruskal test on Se. Kruskal assumes
# equal standard deviation.
# Se
applyLeveneTest(cannabisData, cannabisData$Se)
Se.residuals_kruskal <- kruskal.test(Se ~ Group, data=cannabisData)
kruskalmc(Se ~ Group, data=cannabisData)
Se.reisdual_anova <- applyAnovaTest(cannabisData, cannabisData$Se)
applyShapiroTest(Se.reisdual_anova)
# Fails the shapiro test, indicates does not follow normality. Use Kruskal's
Se.residuals_kruskal <- kruskal.test(Se ~ Group, data=cannabisData)
kruskalmc(Se ~ Group, data=cannabisData)
# Cannot Apply Anova test because data does not have constant spread in there groups of data.
# Resulting we need to use an alternative Anova test that does not assumes equal
# standard deviations.We will use the Welch's Anova test and we have normality here.
# Sm
applyLeveneTest(cannabisData, cannabisData$Sm)
# Fails constant spread test. So we check for normality
Sm.residuals_anova <- applyAnovaTest(cannabisData, cannabisData$Sm)
applyShapiroTest(Sm.residuals_anova)
# Passes normality. Use welch's Test
# Fails normality assumption and so we use welch's Anova
Sm.residuals_welch <- welch.test(Sm ~ Group, data=cannabisData)
# Tm
applyLeveneTest(cannabisData, cannabisData$Tm)
# Tm
applyLeveneTest(cannabisData, cannabisData$Tm)
# Fails constant spread test. So we check for normality
Tm.residuals_anova <- applyAnovaTest(cannabisData, cannabisData$Tm)
applyShapiroTest(Tm.residuals_anova)
# Passes normality. Use welch's Test
# Fails normality assumption and so we use welch's Anova
Tm.residuals_welch <- welch.test(Tm ~ Group, data=cannabisData)
#### Commands needed to execute Question 3.
## calling function to find correlation between 2 elements.
# Sc with Ti
cor(cannabisData$Sc, cannabisData$Ti)
#### Commands needed to execute Question 3.
# calling R function cor(), finds the correlation coefficient ρ which
# which indicates if two datasets are linear related.
# Sc with Ti
cor(cannabisData$Sc, cannabisData$Ti)
ggplot(cannabisData,aes(x = Sc, y = Ti, colour = Group)) +
geom_point() +
stat_smooth(method = ("lm")) +
xlab("Element Sc") +
ylab("Element Ti") +
ggtitle("Relationship between elemenet Sc with Ti")
ggplot(cannabisData,aes(x = Sm, y = Tm, colour = Group)) +
geom_point() +
stat_smooth(method = ("lm")) +
xlab("Element Sm") +
ylab("Element Tm") +
ggtitle("Relationship between elemenet Sm with Tm")
ggplot(cannabisData,aes(x = Sm, y = Sc, colour = Group)) +
geom_point() +
stat_smooth(method = ("lm")) +
xlab("Element Sm") +
ylab("Element Sc") +
ggtitle("Relationship between elemenet Sm with Sc")
ggplot(cannabisData,aes(x = Sm, y = Ti, colour = Group)) +
geom_point() +
stat_smooth(method = ("lm")) +
xlab("Element Sm") +
ylab("Element Ti") +
ggtitle("Relationship between elemenet Sm with Ti")
ggplot(cannabisData,aes(x = Sc, y = Tm, colour = Group)) +
geom_point() +
stat_smooth(method = ("lm")) +
xlab("Element Sc") +
ylab("Element Tm") +
ggtitle("Relationship between elemenet Sc with Tm")
ggplot(cannabisData,aes(x = Sc, y = Ti, colour = Group)) +
geom_point() +
stat_smooth(method = ("lm")) +
xlab("Element Sc") +
ylab("Element Ti") +
ggtitle("Relationship between elemenet Sc with Ti")
ggplot(cannabisData,aes(x = Sc, y = Ti, colour = Group)) +
geom_point() +
stat_smooth(method = ("lm")) +
xlab("Element Sc") +
ylab("Element Ti") +
ggtitle("Relationship between elemenet Sc with Ti")
o
ggplot(cannabisData,aes(x = Sm, y = Tm, colour = Group)) +
geom_point() +
stat_smooth(method = ("lm")) +
xlab("Element Sm") +
ylab("Element Tm") +
ggtitle("Relationship between elemenet Sm with Tm")
ggplot(cannabisData,aes(x = Sm, y = Sc, colour = Group)) +
geom_point() +
stat_smooth(method = ("lm")) +
xlab("Element Sm") +
ylab("Element Sc") +
ggtitle("Relationship between elemenet Sm with Sc")
ggplot(cannabisData,aes(x = Sm, y = Ti, colour = Group)) +
geom_point() +
stat_smooth(method = ("lm")) +
xlab("Element Sm") +
ylab("Element Ti") +
ggtitle("Relationship between elemenet Sm with Ti")
ggplot(cannabisData,aes(x = Sc, y = Tm, colour = Group)) +
geom_point() +
stat_smooth(method = ("lm")) +
xlab("Element Sc") +
ylab("Element Tm") +
ggtitle("Relationship between elemenet Sc with Tm")
p
ggplot(cannabisData,aes(x = Sm, y = Tm, colour = Group)) +
geom_point() +
stat_smooth(method = ("lm")) +
xlab("Element Sm") +
ylab("Element Tm") +
ggtitle("Relationship between elemenet Sm with Tm")
